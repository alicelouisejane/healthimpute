% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/impute_athro.R
\name{impute_anthro}
\alias{impute_anthro}
\title{Impute Missing Anthropometric Values Using CDC Growth Charts}
\usage{
impute_anthro(data, variable, patient_id_col, age_col, sex_col)
}
\arguments{
\item{data}{A data frame containing anthropometric measurements and related metadata.}

\item{variable}{A character string specifying the name of the variable to impute. The name must contain `"weight"`, `"height"`, or `"bmi"`.}

\item{patient_id_col}{A character string specifying the name of the column containing the patient ID.}

\item{age_col}{A character string specifying the name of the column containing age in years.}

\item{sex_col}{A character string specifying the name of the column indicating sex. Values should be coded as `"M"`/`1` for male and `"F"`/`2` for female.}
}
\value{
A data frame that includes:
- the original data,
- an imputed value column (e.g., `imputed_value_weight`), and
- a flag column indicating if the value was imputed (e.g., `weight_carried`).
}
\description{
This function imputes missing anthropometric values (weight, height, or BMI) in a longitudinal dataset of pediatric and adolescent patients using the LMS method from CDC growth charts. It interpolates LMS values, calculates z-scores and percentiles, flags outliers, and imputes missing percentiles using neighboring timepoints. Measurements are back-calculated from imputed percentiles using the LMS formula.

The function supports individuals aged 0 to 20 years using the CDC infant (0–36 months) and child/adolescent (36–240 months) growth standards.
}
\details{
- The input variable name must contain `"weight"`, `"height"`, or `"bmi"`.
- Sex values are standardized to `1 = male` and `2 = female`.
- Percentiles <1 or >100 are flagged as implausible and excluded from imputation.
- Imputed values are estimated using the average of the nearest available percentiles in time.
- Ensure you assign the function in order to store the outputted dataframe in your environment.
}
\examples{
example_data <- data.frame(
  patient_id = c(1, 1, 1, 2, 2),
  sex = c("M", "M", "M", "F", "F"),
  age_at_visit = c(5, 6, 7, 5, 7),
  weightkg = c(NA, 22, NA, 18, NA)
)
impute_anthro(
  data = example_data,
  variable = "weightkg",
  patient_id_col = "patient_id",
  age_col = "age_at_visit",
  sex_col = "sex"
)

}
\author{
Alice Carr
}
